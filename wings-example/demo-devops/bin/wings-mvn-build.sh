#!/bin/bash
# version 2021-12-27

GIT_DIR=/data/git-src/demo-exmaple/
###
cd "$GIT_DIR" || exit

echo -e "\033[37;42;1m ==== Compile $GIT_DIR ==== \033[0m"
mvn -U clean compile  -Dmaven.test.skip=true

git_log=git-log.txt
tgt_lst=git-log.tmp
echo '#Generated by Wings Build Script' > $git_log
git branch -v >> $git_log
git log --pretty=format:'%h - %an, %ad : %s' --graph -10 >> $git_log
find . -type d -name 'classes' | grep '/target/' | while read res; do
    echo $res >> $tgt_lst
    cp $git_log $res/
done

echo -e "\033[37;42;1m ==== Package $GIT_DIR ==== \033[0m"
mvn package

echo -e "\033[37;42;1m ==== GitLogs $GIT_DIR ==== \033[0m"
cat "$git_log"
echo
echo -e "\033[32m ==== git-log into ==== \033[0m"
cat "$tgt_lst"
echo -e "\033[32m ==== git status ==== \033[0m"
git status
rm -f "$git_log"
rm -f "$tgt_lst"
