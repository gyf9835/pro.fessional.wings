# hazelcast 部分手册

Hazelcast在wings中主要用作caching, Session，其次是Event和Lock，还有messaging等。
因其embed启动，进而取代了redis。

## 集群数量和一致性

wings中，Hazelcast版本随spring boot同步更新，主要使用了2个产品。

[Hazelcast IMDG](https://docs.hazelcast.com/imdg/4.2/) 开源版，Apache2许可证（包括独立部署和SpringBoot中的Runtime形式），
相比于Pro和Enterprise版，主要缺少了Persistence和Security suite，在内网中影响不大。

[Management Center](https://docs.hazelcast.com/management-center/5.0/)，没有许可，仅能监控最多3个成员的集群。

在wings的基本应用中，一般只有3个节点(admin/devops/front)构成的集群，使用log和ManagementCenter监控。
因3节点集群的强壮性刚好够用，以CP Subsystem Unsafe Mode运行，仅能提供弱一致性保证，不想CP那样强一致性。

* CP Subsystem Management APIs are not available.
* split-brain protection is not supported.

由此可见，需要强一致性的集群，需要增加节点数，自己设置CP数，同时要自行监控（比如分析日志）

## 监控集群状态

management-center，3节点集群可以直接使用，主要设置强壮密码，禁用script（默认）
```bash
wget https://repository.hazelcast.com/download/management-center/hazelcast-management-center-5.0.4.zip
unzip hazelcast-management-center-5.0.4.zip
cd hazelcast-management-center-5.0.4
nohup bin/start.sh 8090 >hazelcast-management-center.log 2>&1 &
```
访问 http://localhost:8090，同时设置好足够强度的密码即可。

diagnostics.log，查看Metric及其他信息。wings默认的period.seconds是600，即10分钟。
