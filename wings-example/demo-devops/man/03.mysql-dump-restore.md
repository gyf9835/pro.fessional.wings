# mysql数据库备份及恢复

适用于 mysql 5.7/8.0，native/cloud数据库。适用mysqldump备份，适用mysql恢复

## 备份时事项

使用 wings-mysql-dump.sh 脚本进行备份，选择wings.dba权限即可。
若使用 mysqlpump，注意是pump不是dump，需要额外的权限。

根据dump文件中的txt文件进行 scp，gzip 操作。

## 恢复时事项

使用mysqldump的备份时，在trigger时，需要调整其中的DEFINER
```
sed -E 's/DEFINER=[^*]+//g'
```

使用mysqlpump的备份时，需要注意sql中的原database限定，避免错库。
```
sed -E 's/`OLD_DB`/`NEW_DB`/g'
```
## 权限控制

恢复时，log_bin_trust_function_creators = 0，提示SUPER权限。
